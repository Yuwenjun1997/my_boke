# 上传图片及预览

## 说明

使用技术：原生 js 上传图片的方法

原生 js 构造函数：

1. FormData
2. XMLHttpRequest
3. fileReader

## 上传图片

```html
<input type="file" id="fileInput" />
<button onclick="uploadFile()">上传</button>

<script>
	function uploadFile() {
		//获取图片
		var file = document.querySelector('#fileInput').files[0]
		//创建formData对象，并将图片添加到formData中
		var formData = new FormData()
		formData.append('file', file)
		// 利用xhr方式上传
		var xhr = new XMLHttpRequest()
		xhr.open('POST', '/upload')
		xhr.onreadystatechange = function() {
			if (xhr.status === 200 && xhr.readyState == 4) {
				//文件上传成功
			}
		}
		xhr.send(formData)
	}
</script>
```

## 图片预览

```html
<input type="file" id="fileInput" />
<img id="echoImage" />
<button>上传</button>

<script>
	//获取文件上传控件和预览图片的控件
	var echoImage = document.querySelector('#echoImage')
	var fileInput = document.querySelector('#fileInput')

	//为文件上传控件添加onchanges事件
	fileInput.onchange = function() {
		//创建读取文件的对象
		var fileReader = new FileReader()
		//读取文件为base64格式
		fileReader.readAsDataURL(this.files[0])
		//文件读取成功
		fileReader.onload = function(event) {
			//读取到的文件放入img控件
			echoImage.src = event.target.result
		}
	}
</script>
```
