<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>日常开发工具函数 | 前端开发</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/my_boke/logo_42x42.png">
    <meta name="description" content="记录前端使用的技术">
    
    <link rel="preload" href="/my_boke/assets/css/0.styles.1dc4f169.css" as="style"><link rel="preload" href="/my_boke/assets/js/app.08abf35f.js" as="script"><link rel="preload" href="/my_boke/assets/js/2.1e45f81f.js" as="script"><link rel="preload" href="/my_boke/assets/js/10.a47b0953.js" as="script"><link rel="prefetch" href="/my_boke/assets/js/11.d59e539a.js"><link rel="prefetch" href="/my_boke/assets/js/12.5e3f3d52.js"><link rel="prefetch" href="/my_boke/assets/js/13.9be23769.js"><link rel="prefetch" href="/my_boke/assets/js/14.7c82b477.js"><link rel="prefetch" href="/my_boke/assets/js/15.11653181.js"><link rel="prefetch" href="/my_boke/assets/js/16.2a08daf9.js"><link rel="prefetch" href="/my_boke/assets/js/3.ce0460f8.js"><link rel="prefetch" href="/my_boke/assets/js/4.25a60dbd.js"><link rel="prefetch" href="/my_boke/assets/js/5.bdbbe150.js"><link rel="prefetch" href="/my_boke/assets/js/6.df535412.js"><link rel="prefetch" href="/my_boke/assets/js/7.8fd82ea2.js"><link rel="prefetch" href="/my_boke/assets/js/8.84fa2730.js"><link rel="prefetch" href="/my_boke/assets/js/9.80764c14.js">
    <link rel="stylesheet" href="/my_boke/assets/css/0.styles.1dc4f169.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my_boke/" class="home-link router-link-active"><img src="/my_boke/logo_42x42.png" alt="前端开发" class="logo"> <span class="site-name can-hide">前端开发</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/other/01-其它笔记.html" class="nav-link">
  随记
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html" class="nav-link">
  JS相关
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/css/01-日常开发CSS样式类.html" class="nav-link">
  CSS相关
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/node/" class="nav-link">
  nodejs相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue全家桶" class="dropdown-title"><span class="title">Vue全家桶</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue全家桶" class="mobile-dropdown-title"><span class="title">Vue全家桶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/vue2/" class="nav-link">
  vue2.x
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/router/" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/vuex/" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/axios/" class="nav-link">
  axios
</a></li></ul></div></div><div class="nav-item"><a href="/my_boke/zh-cn/webpack.html" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/my_boke/zh-cn/article/" class="nav-link">
  文章分享
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><span class="title">笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记" class="mobile-dropdown-title"><span class="title">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/other/01-其它笔记.html" class="nav-link">
  随记
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html" class="nav-link">
  JS相关
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/css/01-日常开发CSS样式类.html" class="nav-link">
  CSS相关
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/nodes/node/" class="nav-link">
  nodejs相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue全家桶" class="dropdown-title"><span class="title">Vue全家桶</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue全家桶" class="mobile-dropdown-title"><span class="title">Vue全家桶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/vue2/" class="nav-link">
  vue2.x
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/router/" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/vuex/" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/my_boke/zh-cn/vue/axios/" class="nav-link">
  axios
</a></li></ul></div></div><div class="nav-item"><a href="/my_boke/zh-cn/webpack.html" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/my_boke/zh-cn/article/" class="nav-link">
  文章分享
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html" class="active sidebar-link">日常开发工具函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#随机-id-值" class="sidebar-link">随机 ID 值</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#随机-uid" class="sidebar-link">随机 uid</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#生成一个范围内的随机数" class="sidebar-link">生成一个范围内的随机数</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#delay-延迟" class="sidebar-link">delay 延迟</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#倒计时" class="sidebar-link">倒计时</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#时间日期格式化" class="sidebar-link">时间日期格式化</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#url-参数-k-v-的序列化及反序列化" class="sidebar-link">url 参数(k-v)的序列化及反序列化</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#判断浏览器-useragent" class="sidebar-link">判断浏览器 UserAgent</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/01-日常开发工具函数.html#封装-ajax-请求" class="sidebar-link">封装 ajax 请求</a></li></ul></li><li><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html" class="sidebar-link">上传图片及预览</a><ul class="sidebar-sub-headers is-none"><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html#说明" class="sidebar-link">说明</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html#上传图片" class="sidebar-link">上传图片</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html#图片预览" class="sidebar-link">图片预览</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html#大文件切片上传" class="sidebar-link">大文件切片上传</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html#前端代码" class="sidebar-link">前端代码</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html#后端代码" class="sidebar-link">后端代码</a></li></ul></li></ul></li><li><a href="/my_boke/zh-cn/nodes/js/03-生成二维码.html" class="sidebar-link">生成二维码</a><ul class="sidebar-sub-headers is-none"><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/03-生成二维码.html#说明" class="sidebar-link">说明</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/03-生成二维码.html#绘制二维码-下载二维码" class="sidebar-link">绘制二维码，下载二维码</a></li></ul></li><li><a href="/my_boke/zh-cn/nodes/js/04-上拉加载.html" class="sidebar-link">上拉加载</a><ul class="sidebar-sub-headers is-none"><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/04-上拉加载.html#分析" class="sidebar-link">分析</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/04-上拉加载.html#开始封装-过程" class="sidebar-link">开始封装-过程</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/04-上拉加载.html#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/my_boke/zh-cn/nodes/js/04-上拉加载.html#总结" class="sidebar-link">总结</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="日常开发工具函数"><a href="#日常开发工具函数" class="header-anchor">#</a> 日常开发工具函数</h1> <h2 id="随机-id-值"><a href="#随机-id-值" class="header-anchor">#</a> 随机 ID 值</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">randomId</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> n <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> n<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="随机-uid"><a href="#随机-uid" class="header-anchor">#</a> 随机 uid</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">uid</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">len <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">,</span> radix <span class="token operator">=</span> <span class="token number">16</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> chars <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span>
	radix <span class="token operator">=</span> radix <span class="token operator">||</span> chars<span class="token punctuation">.</span>length

	<span class="token keyword">if</span> <span class="token punctuation">(</span>len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> value<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> chars<span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">|</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> radix<span class="token punctuation">)</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">let</span> r
		value<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'-'</span>
		value<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'4'</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">36</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				r <span class="token operator">=</span> <span class="token number">0</span> <span class="token operator">|</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span><span class="token punctuation">)</span>
				value<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> chars<span class="token punctuation">[</span>i <span class="token operator">===</span> <span class="token number">19</span> <span class="token operator">?</span> <span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">0x3</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">0x8</span> <span class="token operator">:</span> r<span class="token punctuation">]</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="生成一个范围内的随机数"><a href="#生成一个范围内的随机数" class="header-anchor">#</a> 生成一个范围内的随机数</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">rangeRandomNum</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>max <span class="token operator">-</span> min <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> min
<span class="token punctuation">}</span>
</code></pre></div><h2 id="delay-延迟"><a href="#delay-延迟" class="header-anchor">#</a> delay 延迟</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">delay</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">delayTime <span class="token operator">=</span> <span class="token number">25</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> delayTime<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="倒计时"><a href="#倒计时" class="header-anchor">#</a> 倒计时</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 倒计时
 * @param diff 倒计时时间/s
 * @param loadTime 运行时的当前时间
 * @param item 倒计时对象
 * @param callback 回调
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">countDown</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">diff<span class="token punctuation">,</span> loadTime<span class="token punctuation">,</span> item<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">function</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token parameter">$diff</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">let</span> dd <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>$diff <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// 计算剩余的天数</span>
		<span class="token keyword">let</span> hh <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$diff <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// 计算剩余的小时数</span>
		<span class="token keyword">let</span> mm <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$diff <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// 计算剩余的分钟数</span>
		<span class="token keyword">let</span> ss <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$diff <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// 计算剩余的秒数</span>

		<span class="token keyword">function</span> <span class="token function">checkTime</span><span class="token punctuation">(</span><span class="token parameter">_a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">let</span> a <span class="token operator">=</span> _a
			<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				a <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> a
			<span class="token punctuation">}</span>
			<span class="token keyword">return</span> a<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		item<span class="token punctuation">.</span>conttainer <span class="token operator">=</span> <span class="token punctuation">{</span>
			ddhh<span class="token operator">:</span> <span class="token function">checkTime</span><span class="token punctuation">(</span>dd <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">+</span> hh<span class="token punctuation">)</span><span class="token punctuation">,</span>
			dd<span class="token operator">:</span> <span class="token function">checkTime</span><span class="token punctuation">(</span>dd<span class="token punctuation">)</span><span class="token punctuation">,</span>
			hh<span class="token operator">:</span> <span class="token function">checkTime</span><span class="token punctuation">(</span>hh<span class="token punctuation">)</span><span class="token punctuation">,</span>
			mm<span class="token operator">:</span> <span class="token function">checkTime</span><span class="token punctuation">(</span>mm<span class="token punctuation">)</span><span class="token punctuation">,</span>
			ss<span class="token operator">:</span> <span class="token function">checkTime</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>conttainer<span class="token punctuation">.</span>dd <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">||</span> item<span class="token punctuation">.</span>conttainer<span class="token punctuation">.</span>hh <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">||</span> item<span class="token punctuation">.</span>conttainer<span class="token punctuation">.</span>mm <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">||</span> item<span class="token punctuation">.</span>conttainer<span class="token punctuation">.</span>ss <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			item<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">let</span> $diff <span class="token operator">=</span> diff <span class="token operator">+</span> <span class="token number">2000</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> loadTime<span class="token punctuation">)</span>
				<span class="token function">round</span><span class="token punctuation">(</span>$diff<span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token function">round</span><span class="token punctuation">(</span>diff <span class="token operator">+</span> <span class="token number">2000</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> loadTime<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="时间日期格式化"><a href="#时间日期格式化" class="header-anchor">#</a> 时间日期格式化</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/** 时间格式化
 * @param {dateTime} date 标准时间格式 -&gt; new Date()
 * @param {string} format 时间格式化的格式 'yyyy-MM-dd hh:mm:ss'
 * @returns {string} 格式化后的时间  '2017-01-01 01:00:00'
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">dateFormat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> format <span class="token operator">=</span> <span class="token string">'yyyy-MM-dd hh:mm:ss'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string">'M+'</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// month</span>
		<span class="token string">'d+'</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// day</span>
		<span class="token string">'h+'</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// hour</span>
		<span class="token string">'m+'</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// minute</span>
		<span class="token string">'s+'</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// second</span>
		<span class="token string">'q+'</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// quarter</span>
		<span class="token constant">S</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// millisecond</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(y+)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		format <span class="token operator">=</span> format<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$<span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'('</span> <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			format <span class="token operator">=</span> format<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$<span class="token number">1</span><span class="token punctuation">,</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span>length <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">'00'</span> <span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span> <span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> format
<span class="token punctuation">}</span>
</code></pre></div><h2 id="url-参数-k-v-的序列化及反序列化"><a href="#url-参数-k-v-的序列化及反序列化" class="header-anchor">#</a> url 参数(k-v)的序列化及反序列化</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
 * 反序列化URL参数
 * { age: &quot;25&quot;, name: &quot;Tom&quot; }
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">parseUrlSearch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">location</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> location<span class="token punctuation">.</span>search
		<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(^\?)|(&amp;$)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">t<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> val<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span>
			t<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
			<span class="token keyword">return</span> t
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * getQueryParams('id')
 * 获取url上某个key的值
 */</span>

<span class="token keyword">const</span> <span class="token function-variable function">getParam</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">param</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 获取浏览器参数</span>
	<span class="token keyword">const</span> r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\\?(?:.+&amp;)?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>param<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=(.*?)(?:&amp;.*)?$</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> m <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
	<span class="token keyword">return</span> m <span class="token operator">?</span> <span class="token function">decodeURI</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
 * queryStringify
 * 将k-v的对象序列化转成 url?k=v&amp;k1=v1;
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">queryStringify</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">search <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>search<span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">t<span class="token punctuation">,</span> v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>t<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>search<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token string">'?'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&amp;$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="判断浏览器-useragent"><a href="#判断浏览器-useragent" class="header-anchor">#</a> 判断浏览器 UserAgent</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">browser</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> u <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span>
		txt<span class="token operator">:</span> u<span class="token punctuation">,</span> <span class="token comment">// userAgent 信息</span>
		version<span class="token operator">:</span> <span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.+(?:rv|it|ra|ie)[\/: ]([\d.]+)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 版本号</span>
		msie<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">msie</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">opera</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// IE内核</span>
		mozilla<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">mozilla</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(compatible|webkit)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 火狐浏览器</span>
		safari<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">safari</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'android'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">chrome</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//是否为safair</span>
		chrome<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">chrome</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//是否为chrome</span>
		opera<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">opera</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//是否为oprea</span>
		presto<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'presto/'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//opera内核</span>
		webKit<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'applewebkit/'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//苹果、谷歌内核</span>
		gecko<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'gecko/'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'khtml'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//火狐内核</span>
		mobile<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>u<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">applewebkit.*mobile.*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//是否为移动终端</span>
		ios<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>u<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\(i[^;]+;( u;)? cpu.+mac os x</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//ios终端</span>
		android<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'android'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//android终端</span>
		iPhone<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'iphone'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//是否为iPhone</span>
		iPad<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'ipad'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//是否为iPad</span>
		weixin<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">micromessenger</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//微信</span>
		QQBrowse<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">' QQ'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">' qq'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// QQ浏览器</span>
		isApp<span class="token operator">:</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'jscp/ios'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'jscp/android'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> <span class="token function">getParamsCode</span><span class="token punctuation">(</span><span class="token string">'source'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'app'</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="封装-ajax-请求"><a href="#封装-ajax-请求" class="header-anchor">#</a> 封装 ajax 请求</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Request</span> <span class="token punctuation">{</span>
	options <span class="token operator">=</span> <span class="token punctuation">{</span>
		responseType<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span>method <span class="token operator">=</span> <span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>method <span class="token operator">=</span> method
		<span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url
		<span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">formatData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
		Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">formatData</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> data <span class="token operator">!=</span> <span class="token string">'object'</span> <span class="token operator">||</span> data <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token keyword">let</span> form <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			form<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> form
	<span class="token punctuation">}</span>
	<span class="token keyword">static</span> <span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">this</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">xhr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">static</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">this</span><span class="token punctuation">(</span><span class="token string">'POST'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">xhr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">xhr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">const</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span>
			xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>responseType
			xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span>
			xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">{</span> status<span class="token operator">:</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">,</span> error<span class="token operator">:</span> xhr<span class="token punctuation">.</span>statusText <span class="token punctuation">}</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token function">resolve</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			xhr<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/my_boke/zh-cn/nodes/js/02-上传图片及预览.html">
        上传图片及预览
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my_boke/assets/js/app.08abf35f.js" defer></script><script src="/my_boke/assets/js/2.1e45f81f.js" defer></script><script src="/my_boke/assets/js/10.a47b0953.js" defer></script>
  </body>
</html>
